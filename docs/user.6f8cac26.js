let e,t;var a,r=globalThis,i={},s={},o=r.parcelRequire2518;null==o&&((o=function(e){if(e in i)return i[e].exports;if(e in s){var t=s[e];delete s[e];var a={id:e,exports:{}};return i[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){s[e]=t},r.parcelRequire2518=o),o.register;var l=o("5eAJY"),n=o("ffKDs"),c=o("ejLRd"),d=o("4DafG"),h=o("gzr8q"),u=o("iQyfo"),p={base32:"0123456789bcdefghjkmnpqrstuvwxyz"},f=function(e,t){var a=e[0],r=e[1];if(!t){for(var i=1;i<=12;i++){var s=f([a,r],i),o=g(s);if(o.lat==r&&o.lon==a)return s}t=12}(t<1||t>12)&&(t=12);for(var l=0,n=0,c=!0,d="",h=-90,u=90,v=-180,m=180;d.length<t;){if(c){var _=(v+m)/2;a>=_?(l=2*l+1,v=_):(l*=2,m=_)}else{var y=(h+u)/2;r>=y?(l=2*l+1,h=y):(l*=2,u=y)}c=!c,5==++n&&(d+=p.base32.charAt(l),n=0,l=0)}return d},g=function(e){var t=v(e),a=t[1],r=t[0],i=t[3],s=t[2],o=(a+i)/2,l=(r+s)/2;return o=o.toFixed(Math.floor(2-Math.log(i-a)/Math.LN10)),[Number(l=l.toFixed(Math.floor(2-Math.log(s-r)/Math.LN10))),Number(o)]},v=function(e){if(!e)return!1;e=e.toLowerCase();for(var t=!0,a=-90,r=90,i=-180,s=180,o=0;o<e.length;o++){var l=e.charAt(o),n=p.base32.indexOf(l);if(-1==n)return!1;for(var c=4;c>=0;c--){var d=n>>c&1;if(t){var h=(i+s)/2;1==d?i=h:s=h}else{var u=(a+r)/2;1==d?a=u:r=u}t=!t}}return[i,a,s,r]};const m=new class extends d.default{constructor(e){var t=e||{},a=document.createElement("div");super({element:a,target:t.target});var r=this,i=document.createElement("button");if((0,u.default).create("I",{parent:i}),this.replaceState_=!1!==t.urlReplace,this.fixed_=t.fixed||6,this.hash_=t.anchor?"#":"?",this._localStorage=t.localStorage,!this._localStorage)try{localStorage.removeItem("ol@permalink")}catch(e){console.warn("Failed to access localStorage...")}function s(){"function"==typeof t.onclick?t.onclick(r.getLink()):r.setUrlReplace(!r.replaceState_)}i.addEventListener("click",s,!1),i.addEventListener("touchstart",s,!1),a.className=(t.className||"ol-permalink")+" ol-unselectable ol-control",a.appendChild(i),(t.hidden||!1===t.visible)&&(0,u.default).hide(a),this.set("geohash",t.geohash),this.set("initial",!1),this.on("change",this.viewChange_.bind(this)),this.search_={};var o={},l=document.location.hash||document.location.search||"";if(this.replaceState_&&!l&&this._localStorage)try{l=localStorage["ol@permalink"]}catch(e){console.warn("Failed to access localStorage...")}if(l){l=l.replace(/(^#|^\?)/,"").split("&");for(var n=0;n<l.length;n++){var c=l[n].split("=");switch(c[0]){case"lon":case"lat":case"z":case"r":o[c[0]]=c[1];break;case"gh":{let e=c[1].split("-"),t=g(e[0]);o.lon=t[0],o.lat=t[1],o.z=e[1];break}case"l":break;default:this.search_[c[0]]=c[1]}}}o.hasOwnProperty("lon")&&this.set("initial",o),this.replaceState_&&this.setPosition()}getInitialPosition(){return this.get("initial")}setMap(e){this._listener&&((0,c.unByKey)(this._listener.change),(0,c.unByKey)(this._listener.moveend)),this._listener=null,super.setMap.call(this,e),e&&(this._listener={change:e.getLayerGroup().on("change",this.layerChange_.bind(this)),moveend:e.on("moveend",this.viewChange_.bind(this))},this.setPosition())}getLayerByLink(e,t){!t&&this.getMap()&&(t=this.getMap().getLayers().getArray());for(var a=0;a<t.length;a++){if(t[a].get("permalink")==e)return t[a];if(t[a].getLayers){var r=this.getLayerByLink(e,t[a].getLayers().getArray());if(r)return r}}return!1}setGeohash(e){this.set("geohash",e),this.setUrlParam()}setPosition(e){var t=this.getMap();if(t){var a=this.replaceState_||e?document.location.hash||document.location.search:"";if(!a&&this._localStorage)try{a=localStorage["ol@permalink"]}catch(e){console.warn("Failed to access localStorage...")}if(a){var r,i,s={};for(r=0,a=a.replace(/(^#|^\?)/,"").split("&");r<a.length;r++)s[(i=a[r].split("="))[0]]=i[1];if(s.gh){var o=s.gh.split("-"),l=g(o[0]);s.lon=l[0],s.lat=l[1],s.z=o[1]}var n=(0,h.transform)([Number(s.lon),Number(s.lat)],"EPSG:4326",t.getView().getProjection());if(n[0]&&n[1]&&t.getView().setCenter(n),s.z&&t.getView().setZoom(Number(s.z)),s.r&&t.getView().setRotation(Number(s.r)),s.l){!function e(a){a||(a=t.getLayers().getArray());for(var r=0;r<a.length;r++)a[r].get("permalink")&&a[r].setVisible(!1),a[r].getLayers&&e(a[r].getLayers().getArray())}();var c=s.l.split("|");for(r=0;r<c.length;r++){i=c[r].split(":");var d=this.getLayerByLink(i[0]),u=Number(i[1]);d&&(d.setOpacity(u),d.setVisible(!0))}}}}}getUrlParams(){return this.search_}setUrlParam(e,t){e&&(void 0===t||""===t?delete this.search_[encodeURIComponent(e)]:this.search_[encodeURIComponent(e)]=encodeURIComponent(t)),this.viewChange_()}getUrlParam(e){return decodeURIComponent(this.search_[encodeURIComponent(e)]||"")}hasUrlParam(e){return this.search_.hasOwnProperty(encodeURIComponent(e))}getLink(e){var t=this.getMap(),a=(0,h.transform)(t.getView().getCenter(),t.getView().getProjection(),"EPSG:4326"),r=Math.round(10*t.getView().getZoom())/10,i=t.getView().getRotation(),s=this.layerStr_,o=(i?"&r="+Math.round(1e4*i)/1e4:"")+(s?"&l="+s:"");if(o=this.get("geohash")?"gh="+f(a,8)+"-"+r+o:"lon="+a[0].toFixed(this.fixed_)+"&lat="+a[1].toFixed(this.fixed_)+"&z="+r+o,"position"===e)return o;for(var l in this.search_)o+="&"+l+(void 0!==this.search_[l]?"="+this.search_[l]:"");return e?o:document.location.protocol+"//"+document.location.host+document.location.pathname+this.hash_+o}getUrlReplace(){return this.replaceState_}setUrlReplace(e){try{if(this.replaceState_=e,e)window.history.replaceState(null,null,this.getLink());else{var t="";for(var a in this.search_)t+=(""==t?"?":"&")+a+(void 0!==this.search_[a]?"="+this.search_[a]:"");window.history.replaceState(null,null,document.location.origin+document.location.pathname+t)}}catch(e){}}viewChange_(){try{this.replaceState_&&window.history.replaceState(null,null,this.getLink())}catch(e){}if(this._localStorage)try{localStorage["ol@permalink"]=this.getLink(this._localStorage)}catch(e){console.warn("Failed to access localStorage...")}}layerChange_(){this._tout&&(clearTimeout(this._tout),this._tout=null),this._tout=setTimeout((function(){this._tout=null;var e="";(function t(a){for(var r=0;r<a.length;r++)a[r].getVisible()&&a[r].get("permalink")&&(e&&(e+="|"),e+=a[r].get("permalink")+":"+a[r].get("opacity")),a[r].getLayers&&t(a[r].getLayers().getArray())})(this.getMap().getLayers().getArray()),this.layerStr_=e,this.viewChange_()}).bind(this),200)}};(0,n.default).addControl(m);var _=o("cmWwo"),y=o("g3PuQ"),b=o("avjdK"),w=o("9qTgy"),u=o("iQyfo"),k=o("cxYyG"),L=o("bQI6B");/\/$/.test(k.default.server)||(k.default.server+="/");const S={home:k.default.server,signal:k.default.server+"signaler",contact:k.default.server+"nous-contacter",accessibility:k.default.server+"declaration-daccessibilite-rgaa.pdf",logout:k.default.server+"deconnexion",api:k.default.server+"api",media:k.default.server+"api/image",macarte:k.default.server+"edition/carte",mestat:k.default.server+"edition/statistique",narration:k.default.server+"edition/narration",geocod:k.default.server+"edition/adresses",search:k.default.server+"atlas",createAccount:k.default.server+"creer-un-compte",initPassword:k.default.server+"recuperer-mon-mot-de-passe",unlockAccount:k.default.server+"debloquer-mon-compte",user:k.default.server+"mon-compte",profil:k.default.server+"mon-compte/#profil",mescartes:k.default.server+"mon-compte/#cartes",mesmedias:k.default.server+"mon-compte/#medias",mention:k.default.server+"mentions-legales",cgu:k.default.server+"cgu",cookie:k.default.server+"cookies-et-statistiques",doc:k.default.server+"aide",blog:k.default.server+"aide/blog",tuto:k.default.server+"aide/tutoriels",faq:k.default.server+"aide/faq",version:k.default.server+"aide/notes-de-version"};for(let e in S)k.default[e]&&(S[e]=k.default[e]);o("aODzy");var u=o("iQyfo");const M=(0,u.default).create("DIV",{className:"page-loader hidden",html:"<div><p></p></div>",parent:document.body}),x=(0,u.default).create("DIV",{className:"info",parent:M});var C={show:(t,a)=>{x.innerHTML=a||"",M.style.display="block",e&&clearTimeout(e),0===t?M.classList.remove("hidden"):e=setTimeout(()=>{M.classList.remove("hidden")},t||200)},hide:()=>{M.classList.add("hidden"),e&&clearTimeout(e),e=setTimeout(()=>{M.style.display="none"},200)}},U=o("6YKa7"),N={};N='<div data-attr="cover_picture"></div><div class="header-profile"> <div data-attr="profile_picture"></div> <h1 data-attr="public_name"></h1> <div class="social-networks"> <ul> <li class="social-network" data-attr="twitter_account"> <a target="_blank"> <i class="fa fa-twitter" aria-hidden="true"></i> </a> </li> <li class="social-network" data-attr="facebook_account"> <a target="_blank"> <i class="fa fa-facebook" aria-hidden="true"></i> </a> </li> <li class="social-network" data-attr="linkedin_account"> <a target="_blank"> <i class="fa fa-linkedin" aria-hidden="true"></i> </a> </li> </ul> </div> </div><div class="subheader"> <div class="description" data-role="teaser-1"> <div> <article> <h3>Description</h3> <div data-attr="presentation"></div> </article> </div> </div> <div class="statistics" data-role="teaser-1"> <div> <article> <h3>Statistiques</h3> <p><b>Membre depuis :</b> <span data-attr="registered_at"></span></p> <p><b>Nombre de cartes partag√©es :</b> <span data-attr="nb_shared_maps"></span></p> <p><b>Nombre de vues :</b> <span data-attr="nb_views"></span></p> </article> </div> </div> </div><div class="maps-result"></div>',(0,l.default).setApp("user","Ma carte"),C.show(0);const P=(0,l.default).getAppElement();P.innerHTML=(a=N)&&a.__esModule?a.default:a;let I=m.getUrlParam("user").split("_").pop();I||(I=document.location.pathname.split("/").pop().split("_").pop()),I?(0,b.default).getUser(I,e=>{if(!e||e.error){T();return}t=e,R.removeFilter("user"),R.setFilter("user",t.public_name),R.search(),C.hide(),(0,U.default)(t,P)}):T();const R=new w.default(b.default,{context:"atlas",search:!0,mode:"gallery",target:P.querySelector(".maps-result")});function T(){C.hide(),(0,y.default).show404(e,"Utilisateur inexistant");let e=(0,u.default).create("A",{html:'consulter l\'atlas...<i class="fa fa-external-link"></i>',href:_.default.search,parent:(0,y.default).getContentElement()})}R.setMode("gallery"),R.on("click",e=>{window.open(function(e,t){var a;let r=e.view_id||e.id;if(!r)return"";let i=(a=e.title||"macarte",a=(a=(0,L.default)(a)).replace(/[^a-zA-Z0-9]/g,"-").replace(/-{2,}/g,"-")),s=(0,k.default).viewer.replace("$ID",r).replace("$TITLE",encodeURIComponent(i)).replace("$NOTITLE",!1===e.showTitle?"notitle":"");if(s=s.replace(/[?|&]$/,""),e.position&&e.position.length){let t="lon="+e.position[0]+"&lat="+e.position[1]+"&z="+e.position[2];s+=/\?/.test(s)?"&"+t:"?"+t}return e.noZoom&&(s+=(/\?/.test(s)?"&":"?")+"noZoom"),s}(e.item),"_blank")});